{"version":3,"file":"static/js/192.784053d8.chunk.js","mappings":"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","sources":["pages/admin/Login/LoginPage.js","services/api.js","services/authService.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useTranslation } from \"react-i18next\";\nimport { toast } from 'react-toastify';\nimport { login } from '../../../services/authService';\nimport \"./LoginPage.css\";\n\nconst LoginPage = ({ setToken }) => {\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const navigate = useNavigate();\n  const { t } = useTranslation();\n\n  useEffect(() => {\n    if (localStorage.getItem('token')) {\n      navigate('/admin/home');\n    }\n  }, [navigate]);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    try {\n      const { access_token } = await login({ username, password }); // ВАЖНО: access_token\n      setToken(access_token);\n      localStorage.setItem('token', access_token);\n      navigate('/admin/home');\n      toast.success('Успешный вход');\n    } catch (error) {\n      console.error('Ошибка входа', error);\n      toast.error(error.response?.data?.detail || 'Ошибка входа');\n    }\n  };\n\n  return (\n    <main className=\"d-flex align-items-center py-4 bg-body-tertiary vh-100\">\n      <div className=\"form-signin w-100 m-auto text-center\">\n        <form onSubmit={handleSubmit}>\n          <img className=\"mb-4\" src=\"https://getbootstrap.com/docs/5.3/assets/brand/bootstrap-logo-shadow.png\" alt=\"logo\" width=\"72\" height=\"57\" />\n          <h1 className=\"h3 mb-3 fw-normal\">{t('please_sign_in')}</h1>\n\n          <div className=\"form-floating mb-2\">\n            <input\n              type=\"text\"\n              className=\"form-control\"\n              id=\"floatingInput\"\n              placeholder=\"name@example.com\"\n              value={username}\n              onChange={(e) => setUsername(e.target.value)}\n              required\n            />\n            <label htmlFor=\"floatingInput\">{t('username')}</label>\n          </div>\n          <div className=\"form-floating mb-3\">\n            <input\n              type=\"password\"\n              className=\"form-control\"\n              id=\"floatingPassword\"\n              placeholder=\"Password\"\n              value={password}\n              onChange={(e) => setPassword(e.target.value)}\n              required\n            />\n            <label htmlFor=\"floatingPassword\">{t('password')}</label>\n          </div>\n\n          <button className=\"btn btn-primary w-100 py-2 mb-2\" type=\"submit\">\n            {t('sign_in')}\n          </button>\n          <button className=\"btn btn-outline-secondary w-100 py-2 mb-3\" type=\"button\">\n            <svg className=\"bi me-1\" width=\"16\" height=\"16\"><use xlinkHref=\"#twitter\" /></svg>\n            {t('sign_in_with_twitter')}\n          </button>\n          <p className=\"mt-5 mb-3 text-body-secondary\">© 2024</p>\n        </form>\n      </div>\n    </main>\n  );\n};\n\nexport default LoginPage;\n","// src/services/api.js\r\nimport axios from 'axios';\r\n\r\nconst api = axios.create({\r\n  baseURL: process.env.REACT_APP_API_URL,\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n  },\r\n});\r\n\r\n// Добавляем токен автоматически перед каждым запросом\r\napi.interceptors.request.use(\r\n  (config) => {\r\n    const token = localStorage.getItem('token');\r\n    if (token) {\r\n      config.headers['Authorization'] = `Bearer ${token}`; // << исправлено\r\n    }\r\n    return config;\r\n  },\r\n  (error) => {\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport default api;\r\n","// src/services/authService.js\r\nimport api from './api';\r\n\r\nexport const login = async (credentials) => {\r\n    const formData = new URLSearchParams();\r\n    formData.append('username', credentials.username);\r\n    formData.append('password', credentials.password);\r\n  \r\n    const response = await api.post('/auth/login', formData, {\r\n      headers: {\r\n        'Content-Type': 'application/x-www-form-urlencoded', // очень важно\r\n      },\r\n    });\r\n  \r\n    return response.data; // { access_token: \"...\", token_type: \"bearer\" }\r\n  };\r\n  \r\n  export const register = (userData) => {\r\n    return api.post('/auth/register', userData);\r\n  };\r\n  \r\n  export const logout = () => {\r\n    localStorage.removeItem('token'); // или sessionStorage, если ты используешь его\r\n    window.location.href = '/login'; // Редирект\r\n  };"],"names":["_ref","setToken","_useState","useState","_useState2","_slicedToArray","username","setUsername","_useState3","_useState4","password","setPassword","navigate","useNavigate","t","useTranslation","useEffect","localStorage","getItem","handleSubmit","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","e","_yield$login","access_token","_error$response","_error$response$data","wrap","_context","prev","next","preventDefault","login","sent","setItem","toast","success","t0","console","error","response","data","detail","stop","_x","apply","arguments","_jsx","className","children","_jsxs","onSubmit","src","alt","width","height","type","id","placeholder","value","onChange","target","required","htmlFor","xlinkHref","api","axios","create","baseURL","process","headers","interceptors","request","use","config","token","concat","Promise","reject","credentials","formData","URLSearchParams","append","post","abrupt","logout","removeItem","window","location","href"],"sourceRoot":""}